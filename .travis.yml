language: bash
matrix:
  include:
    - os: linux
      services: docker
      language: bash
      env: TEST_SUITE=lint
      script:
      - ./bin/manage ci
    - os: linux
      services: docker
      language: bash
      env: TEST_SUITE=fedora
      script:
      - ./bin/manage ci
    - os: linux
      services: docker
      language: bash
      env: TEST_SUITE=alpine
      script:
      - ./bin/manage ci
    - os: osx
      language: bash
      env: TEST_SUITE=osx
      script:
      - brew update
      - brew install bash
      - brew install gnu-sed
      - brew upgrade coreutils
      - brew upgrade gnupg
      - brew upgrade git
      - /usr/local/bin/bash --version
      - /usr/local/bin/bash bin/manage ci
branches:
  only:
    - staging
    - development
    - next
    - /^v?\d+\.\d+\.\d+$/
    - /^\d+\.\d+\.\d+$/
    - /^new-.*$/
    - /^feat-.*$/
    - /^add-.*$/
    - /^change-.*$/
    - /^breaking-.*$/
    - /^deprecate-.*$/
    - /^remove-.*$/
    - /^fix-.*$/
    - /^sec-.*$/
    - /^security-.*$/
    - /^perf-.*$/
    - /^performance-.*$/
    - /^test-.*$/
    - /^tests-.*$/
notifications:
  email:
    on_success: change
    on_failure: always
